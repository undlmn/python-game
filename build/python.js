(async()=>{const[t,n]=await Promise.all([async function(t){"loading"==document.readyState&&await new Promise((t=>h(window,"DOMContentLoaded",t)));return document.getElementById(t)}("python"),async function(t){const n=await fetch(t);return n.ok?await n.arrayBuffer():null}([...document.querySelectorAll("script")].pop().dataset.url)]);let e=[];const[o,r]=function({t:t,w:n,o:e,i:o,l:r=8,u:c=8,p:i=60,_:s=4,m:a}){const l=n*r,u=e*c,f=1e3/i;t.width=l,t.height=u;const w=t.getContext("2d"),d=[];w.clearRect(0,0,l,u),w.drawImage(o,0,0);for(let t=0;t<16;t++)for(let n=0;n<16;n++)d.push(w.getImageData(n*r,t*c,r,c));w.clearRect(0,0,l,u);const y=new Uint8Array(n*e),p=new Uint8Array(n*e),_={};let m=[];const A=window.requestAnimationFrame;let x;function U(t){let n;x||(x=t+f,n=!0);let e=0;for(;x<=t;){if(e>s){x=t+f,e=1;break}x+=f,e++}for(let t=e;t--;)a(t);if(e||n){_.A||m.reverse().forEach((([t,n,e])=>w.putImageData(t,n,e)));for(let t=0,e=0;e<u;e+=c)for(let o=0;o<l;o+=r,t++){let r=p[t];(y[t]!==r||n)&&(w.putImageData(d[r],o,e),y[t]=r)}m=[],Object.values(_).filter((t=>t&&t.length)).forEach((([t,n,e])=>{const o=w.getImageData(n,e,r,c);m.push([o,n,e]);const i=d[t].data,s=new ImageData(r,c),a=s.data;for(let t,n=r*c*4;n--;)3==(3&n)&&(t=i[n]?i:o.data),a[n]=t[n];w.putImageData(s,n,e)}))}A(U)}return A(U),[p,_]}({t:t,w:36,o:28,i:await async function(t,n){const e=document.createElement("img");return e.src=URL.createObjectURL(new Blob([t],{type:n})),await new Promise((t=>h(e,"load",t))),e}(new Uint8Array(n,1945,2956),"image/gif"),m(t){for(let n=0;n<e.length;n++){const o=e[n];o.U?o.U--:(o.m(t),o.U=o.g)}}});let c;var i;i=({code:t,type:n})=>{if(c){const e=c.keys.indexOf(t),o="d"==n[3]?c.h:c.S;~e&&o&&(o(e),event.preventDefault())}},h(document,"keydown",i),h(document,"keyup",i);const s=(t,n)=>36*n+t;function a(t,e,o,r,c,i){for(let a=0;a<i;a++)new Uint8Array(t.buffer,s(o,r+a),36-o).set(new Uint8Array(n,c*a+e,c))}function l(t,n,e,o,r=6){`      ${n}`.slice(-r).split``.forEach(((n,r)=>t[s(e,o)+r]=" "==n?0:n.charCodeAt()))}function u(){e=[],c=null,r.k=null,r.A=!1}function f(t){return localStorage.getItem(`python_${t}`)}function w(t,n){return localStorage.setItem(`python_${t}`,n)}let d,y,p=+f("topScore")||500,_=+f("lastScore")||0;function m(t){_+=t,w("lastScore",_),p<_&&(p=_,w("topScore",p))}let A=[];function x(t,n){const e=d.createBufferSource();return e.buffer=A[t],e.connect(n||y),e.start(),new Promise((t=>e.onended=t))}async function U(){u(),o.fill(0),await P(50),a(o,0,9,4,6,1),a(o,6,21,4,4,1),a(o,10,8,10,20,5),a(o,110,10,20,15,1),a(o,125,10,22,15,1),l(o,p,8,6),l(o,_,19,6),c={keys:["Space"],h:g}}async function g(){await async function(){if(!d){d=new(window.AudioContext||window.webkitAudioContext);let t=4901;for(const e of[34480,65420,117242,203649,205945,208919,256509,292880,400963])A.push(await d.decodeAudioData(n.slice(t,e))),t=e;y=d.createGain(),y.connect(d.destination),y.gain.value=.5}}();let t=0,i=3;async function f(){u(),r.A=!0,a(o,908,12,12,13,1),await x(8),U()}_=0,async function n(){u(),o.fill(0),await P(500);const w=function(){const t=d.createGain();t.connect(y),t.gain.value=.5;let n=!0;return(async()=>{const e=[3,3,2,1,1,2,1,1,0];for(let o=9;n;o||(o=8))await x(e[--o],t)})(),()=>{n=!1,t.gain.value=0}}(),A=new Uint8Array(1008);A.fill(1),a(A,140,2,2,32,24),l(A,i,17,25,3);const U=new Uint8Array(1008);a(U,921+256*t,9,5,16,16);let g=-1,h=[];c={keys:["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Escape"],h(t){g=t,h.includes(t)||h.push(t)},S(t){h=h.filter((n=>n!=t)),g==t&&(g=h.length?h[h.length-1]:-1)}};const b=new Uint8Array(1008),v=[{x:23,y:12,P:S(2),v:128+36*S(3)},{x:8,y:5,P:S(2),v:125+36*S(3)},{x:11,y:17,P:S(2),v:124+36*S(3)},{x:18,y:12,P:S(2),v:123+36*S(3)},{x:17,y:5,P:S(2),v:120+36*S(3)},{x:8,y:10,P:S(2),v:119+36*S(3)},{x:22,y:6,P:S(2),v:114+36*S(3)},{x:17,y:17,P:S(2),v:113+36*S(3)},{x:12,y:12,P:S(2),v:111+36*S(3)},{x:12,y:8,P:S(2),v:108+36*S(3)}];let D=v.length;const L=(t,n)=>{const e=E-t,o=H-n;return 0==e&&k(o,-2,1)||k(o,-1,0)&&k(e,-1,1)},M=(t,n,e)=>{for(let o=0;o<D;o++)if(t!=o&&n==v[o].x&&k(e-v[o].y,-1,1))return!0;const o=s(n,e-1),r=s(n,e);return 1!=A[o]||1!=A[r]||$[o]||$[r]||n==E&&k(e-H,0,1)};e.push({m(){b.fill(0);for(let t=0;t<D;t++){const n=v[t];let{x:e,y:o}=n;if(n.D)n.D--;else if(n.v<102&&!S(6)&&L(e,o)&&(n.v=0),n.v)n.v--;else if(U[s(e,o)]&&!L(e,o))U[s(e,o)]=0,n.D=204,n.v=108,n.P=!n.P;else{const r=[],c=[],i=[],a=[];for(let n=-1;n<2;n++)for(let l=-1;l<2;l++){const u=e+l,f=o+n;!l&&!n||M(t,u,f)||(L(u,f)?a.push([l,n]):U[s(u,f)]?r.push([l,n]):U[s(u,f-1)]?c.push([l,n]):i.push([l,n]))}const l=r.length?r:c.length?c:i.length?i:a,u=l.length;if(u){const[t,r]=l[S(u)];n.x=e+=t,n.y=o+=r,n.P=t>0?0:t<0?1:+(r>0),x(4)}else n.P=S(2);n.v=107}const{P:r,v:c}=n;b[s(e,o-1)]=96+(n.D?2+r+(n.D/5&1?2:0):c>107||c/18&1?r:!r),b[s(e,o)]=112+r+(n.D?2:0)}}});const $=new Uint8Array(1008),O=[141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,133];let R,j,B,C,E=27,H=21,I=E,T=H,W=0;const q=(t,n)=>1==A[s(t,n)]&&!$[s(t,n)],z=()=>{for(let t=0;t<D;t++)if(E==v[t].x&&k(v[t].y-H,0,1)){j=!0,v.splice(t,1),D--,U[s(E,H)]=0,m(100),G+=8;break}U[s(E,H)]&&(j=!0,C=!0,U[s(E,H)]=0),j&&x(5)};e.push({m(){if(!W){if(C||F||4==g)return X();if(!D)return V();if(0==g&&q(E,H-1)){const t=12&O[0];4==t&&(O[0]=132),8==t&&(O[0]=136),12==t&&(O[0]=140),H--,R=136,W=12,z()}if(1==g&&q(E+1,H)){const t=12&O[0];0==t&&(O[0]=129),8==t&&(O[0]=137),12==t&&(O[0]=141),E++,R=141,W=12,z()}if(2==g&&q(E,H+1)){const t=12&O[0];0==t&&(O[0]=130),4==t&&(O[0]=134),12==t&&(O[0]=142),H++,R=130,W=12,z()}if(3==g&&q(E-1,H)){const t=12&O[0];0==t&&(O[0]=131),4==t&&(O[0]=135),8==t&&(O[0]=139),E--,R=135,W=12,z()}}if(1==W){if(O.unshift(R),I=E,T=H,!B){O.pop();const t=O.length-1,n=3&O[t];0==n&&(O[t]=128),1==n&&(O[t]=133),2==n&&(O[t]=138),3==n&&(O[t]=143)}B=j,j=!1}const t=W>1?3-((W-2)/3|0):0;$.fill(0);let n=I,e=T;O.forEach((o=>{$[s(n,e)]=o+(B?0:16*t);const r=12&o;0==r&&e--,4==r&&n++,8==r&&e++,12==r&&n--})),r.k=[208+(3&O[0])+(j?8:C?4:0),8*(I-(I-E)*t/4),8*(T-(T-H)*t/4)],W&&W--}});let F,G=73;e.push({g:25-5*t,m(){G?G--:F=!0;for(let t=0,n=0;t<9;t++,n=8*t)A[922+t]=86+(G<n?0:G>=n+8?8:G-n)}});let J=0,K=0;e.push({g:5,m(){J?(A[s(30,6+K)]=109-J,J--):S(4)||(J=5,K=S(8))}});const N=[714,750,751,786,787,824,860,861,897];let Q=2;function V(){w(),u(),r.A=!0;const c=[];for(let t=1008;t--;)U[t]&&c.push(t);e=[{g:2,async m(){c.length?(o[c.pop()]=1,m(5),l(o,p,3,25),l(o,_,10,25),x(4)):(u(),await x(6),t++,t>3?f():n())}}]}async function X(){let t,a;w(),c=null,e=[{U:1,g:2,m(){if(t&&a)return i--?n():f();let e=E,c=H;O.forEach((n=>{o[s(e,c)]=n+(t?64:0);const r=12&n;0==r&&c--,4==r&&e++,8==r&&c++,12==r&&e--})),r.k=[208+(3&O[0])+(C?4:0)+(t?16:0),8*E,8*H],t=!t}}],await x(7),a=!0}e.push({g:7,m(){N.forEach((t=>A[t]=111-Q)),Q--||(Q=2)}}),e.push({m(){l(A,p,3,25),l(A,_,10,25),function(...t){for(let n=1008;n--;)o[n]=t.map((t=>t[n])).reduceRight(((t,n)=>n||t))}($,b,U,A)}})}()}function h(t,n,e,o){t.addEventListener(n,e,o)}function S(t){return t&&Math.round(Math.random()*(t-1))}function k(t,n,e){return t>=n&&t<=e}function P(t){return new Promise((n=>setTimeout(n,t)))}U()})();