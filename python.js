(async()=>{const[t,n]=await Promise.all([async function(t){"loading"==document.readyState&&await new Promise((t=>v(window,"DOMContentLoaded",t)));return document.getElementById(t)}("python"),async function(t){const n=await fetch(t);return n.ok?await n.arrayBuffer():null}([...document.querySelectorAll("script")].pop().dataset.url)]);let e=[];const[o,c]=function({t:t,w:n,o:e,i:o,u:c=8,l:r=8,p:i=60,m:s=4,_:a}){const u=n*c,l=e*r,f=1e3/i;t.width=u,t.height=l;const w=t.getContext("2d"),d=[];w.clearRect(0,0,u,l),w.drawImage(o,0,0);for(let t=0;t<16;t++)for(let n=0;n<16;n++)d.push(w.getImageData(n*c,t*r,c,r));w.clearRect(0,0,u,l);const y=new Uint8Array(n*e),p=new Uint8Array(n*e),m={};let _=[];const h=window.requestAnimationFrame;let A;function x(t){let n;A||(A=t+f,n=!0);let e=0;for(;A<=t;){if(e>s){A=t+f,e=1;break}A+=f,e++}for(let t=e;t--;)a(t);if(e||n){m.h||_.reverse().forEach((([t,n,e])=>w.putImageData(t,n,e)));for(let t=0,e=0;e<l;e+=r)for(let o=0;o<u;o+=c,t++){let c=p[t];(y[t]!==c||n)&&(w.putImageData(d[c],o,e),y[t]=c)}_=[],Object.values(m).filter((t=>t&&t.length)).forEach((([t,n,e])=>{const o=w.getImageData(n,e,c,r);_.push([o,n,e]);const i=d[t].data,s=new ImageData(c,r),a=s.data;for(let t,n=c*r*4;n--;)3==(3&n)&&(t=i[n]?i:o.data),a[n]=t[n];w.putImageData(s,n,e)}))}h(x)}return h(x),[p,m]}({t:t,w:36,o:28,i:await async function(t,n){const e=document.createElement("img");return e.src=URL.createObjectURL(new Blob([t],{type:n})),await new Promise((t=>v(e,"load",t))),e}(new Uint8Array(n,1945,2956),"image/gif"),_(t){for(let n=0;n<e.length;n++){const o=e[n];o.A?o.A--:(o._(t),o.A=o.U)}}});let r,i,s,a;!function(t){const n={passive:!1};v(document,"keydown",t,n),v(document,"keyup",t,n)}((t=>{if(r){const n=r.keys.indexOf(t.code),e="d"==t.type[3]?r.g:r.S;~n&&e&&(e(n),t.preventDefault())}}));let u=-1;!function(t){const n={passive:!1};v(document,"touchstart",t,n),v(document,"touchmove",t,n),v(document,"touchend",t,n),v(document,"touchcancel",t,n)}((t=>{t.preventDefault();const n=t.type[5];u=-1;const e=t.touches[0]?.pageX,o=t.touches[0]?.pageY;if("s"==n&&(s=e,a=o),"m"==n){const t=s-e,n=a-o,c=Math.abs(t),r=Math.abs(n);(c>9||r>9)&&(u=c>r?t>0?3:1:n>0?0:2)}("s"==n?i.start:"m"==n?i.move:i.end)?.(e,o)}));const l=(t,n)=>36*n+t;function f(t,e,o,c,r,i){for(let s=0;s<i;s++)new Uint8Array(t.buffer,l(o,c+s),36-o).set(new Uint8Array(n,r*s+e,r))}function w(t,n,e,o,c=6){`      ${n}`.slice(-c).split``.forEach(((n,c)=>t[l(e,o)+c]=" "==n?0:n.charCodeAt()))}function d(){e=[],r=null,i=null,c.k=null,c.h=!1}function y(t){return localStorage.getItem(`python_${t}`)}function p(t,n){return localStorage.setItem(`python_${t}`,n)}let m,_,h=+y("topScore")||500,A=+y("lastScore")||0;function x(t){A+=t,p("lastScore",A),h<A&&(h=A,p("topScore",h))}let U=[];function g(t,n){const e=m.createBufferSource();return e.buffer=U[t],e.connect(n||_),e.start(),new Promise((t=>e.onended=t))}async function S(){d(),o.fill(0),await b(50),f(o,0,9,4,6,1),f(o,6,21,4,4,1),f(o,10,8,10,20,5),f(o,110,10,20,15,1),f(o,125,10,22,15,1),w(o,h,8,6),w(o,A,19,6),r={keys:["Space"],g:k},i={end:k}}async function k(){d(),await async function(){if(!m){m=new(window.AudioContext||window.webkitAudioContext),m.resume();let t=4901;for(const e of[34480,65420,117242,203649,205945,208919,256509,292880,400963])U.push(await m.decodeAudioData(n.slice(t,e))),t=e;_=m.createGain(),_.connect(m.destination),_.gain.value=.1}}();let t=0,i=3;async function s(){d(),c.h=!0,f(o,908,12,12,13,1),await g(8),S()}A=0,async function n(){d(),o.fill(0),await b(500);const a=function(){const t=m.createGain();t.connect(_),t.gain.value=.6;let n=!0;return(async()=>{const e=[3,3,2,1,1,2,1,1,0];for(let o=9;n;o||(o=8))await g(e[--o],t)})(),()=>{n=!1,t.gain.value=0}}(),y=new Uint8Array(1008);y.fill(1),f(y,140,2,2,32,24),w(y,i,17,25,3);const p=new Uint8Array(1008);f(p,921+256*t,9,5,16,16);let U=-1,S=[];r={keys:["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Escape"],g(t){U=t,S.includes(t)||S.push(t)},S(t){S=S.filter((n=>n!=t)),U==t&&(U=S.length?S[S.length-1]:-1)}};const k=new Uint8Array(1008),v=[{x:23,y:12,v:M(2),M:128+36*M(3)},{x:8,y:5,v:M(2),M:125+36*M(3)},{x:11,y:17,v:M(2),M:124+36*M(3)},{x:18,y:12,v:M(2),M:123+36*M(3)},{x:17,y:5,v:M(2),M:120+36*M(3)},{x:8,y:10,v:M(2),M:119+36*M(3)},{x:22,y:6,v:M(2),M:114+36*M(3)},{x:17,y:17,v:M(2),M:113+36*M(3)},{x:12,y:12,v:M(2),M:111+36*M(3)},{x:12,y:8,v:M(2),M:108+36*M(3)}];let D=v.length;const L=(t,n)=>{const e=H-t,o=I-n;return 0==e&&P(o,-2,1)||P(o,-1,0)&&P(e,-1,1)},$=(t,n,e)=>{for(let o=0;o<D;o++)if(t!=o&&n==v[o].x&&P(e-v[o].y,-1,1))return!0;const o=l(n,e-1),c=l(n,e);return 1!=y[o]||1!=y[c]||O[o]||O[c]||n==H&&P(e-I,0,1)};e.push({_(){k.fill(0);for(let t=0;t<D;t++){const n=v[t];let{x:e,y:o}=n;if(n.P)n.P--;else if(n.M<102&&!M(6)&&L(e,o)&&(n.M=0),n.M)n.M--;else if(p[l(e,o)]&&!L(e,o))p[l(e,o)]=0,n.P=204,n.M=108,n.v=!n.v;else{const c=[],r=[],i=[],s=[];for(let n=-1;n<2;n++)for(let a=-1;a<2;a++){const u=e+a,f=o+n;!a&&!n||$(t,u,f)||(L(u,f)?s.push([a,n]):p[l(u,f)]?c.push([a,n]):p[l(u,f-1)]?r.push([a,n]):i.push([a,n]))}const a=c.length?c:r.length?r:i.length?i:s,u=a.length;if(u){const[t,c]=a[M(u)];n.x=e+=t,n.y=o+=c,n.v=t>0?0:t<0?1:+(c>0),g(4)}else n.v=M(2);n.M=107}const{v:c,M:r}=n;k[l(e,o-1)]=96+(n.P?2+c+(n.P/5&1?2:0):r>107||r/18&1?c:!c),k[l(e,o)]=112+c+(n.P?2:0)}}});const O=new Uint8Array(1008),R=[141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,133];let j,B,C,E,H=27,I=21,T=H,W=I,q=0;const z=(t,n)=>1==y[l(t,n)]&&!O[l(t,n)],F=()=>{for(let t=0;t<D;t++)if(H==v[t].x&&P(v[t].y-I,0,1)){B=!0,v.splice(t,1),D--,p[l(H,I)]=0,x(100),J+=8;break}p[l(H,I)]&&(B=!0,E=!0,p[l(H,I)]=0),B&&g(5)};e.push({_(){if(!q){if(E||G||4==U)return Y();if(!D)return X();if((0==U||0==u)&&z(H,I-1)){const t=12&R[0];4==t&&(R[0]=132),8==t&&(R[0]=136),12==t&&(R[0]=140),I--,j=136,q=12,F()}if((1==U||1==u)&&z(H+1,I)){const t=12&R[0];0==t&&(R[0]=129),8==t&&(R[0]=137),12==t&&(R[0]=141),H++,j=141,q=12,F()}if((2==U||2==u)&&z(H,I+1)){const t=12&R[0];0==t&&(R[0]=130),4==t&&(R[0]=134),12==t&&(R[0]=142),I++,j=130,q=12,F()}if((3==U||3==u)&&z(H-1,I)){const t=12&R[0];0==t&&(R[0]=131),4==t&&(R[0]=135),8==t&&(R[0]=139),H--,j=135,q=12,F()}}if(1==q){if(R.unshift(j),T=H,W=I,!C){R.pop();const t=R.length-1,n=3&R[t];0==n&&(R[t]=128),1==n&&(R[t]=133),2==n&&(R[t]=138),3==n&&(R[t]=143)}C=B,B=!1}const t=q>1?3-((q-2)/3|0):0;O.fill(0);let n=T,e=W;R.forEach((o=>{O[l(n,e)]=o+(C?0:16*t);const c=12&o;0==c&&e--,4==c&&n++,8==c&&e++,12==c&&n--})),c.k=[208+(3&R[0])+(B?8:E?4:0),8*(T-(T-H)*t/4),8*(W-(W-I)*t/4)],q&&q--}});let G,J=73;e.push({U:25-5*t,_(){J?J--:G=!0;for(let t=0,n=0;t<9;t++,n=8*t)y[922+t]=86+(J<n?0:J>=n+8?8:J-n)}});let K=0,N=0;e.push({U:5,_(){K?(y[l(30,6+N)]=109-K,K--):M(4)||(K=5,N=M(8))}});const Q=[714,750,751,786,787,824,860,861,897];let V=2;function X(){a(),d(),c.h=!0;const r=[];for(let t=1008;t--;)p[t]&&r.push(t);e=[{U:2,async _(){r.length?(o[r.pop()]=1,x(5),w(o,h,3,25),w(o,A,10,25),g(4)):(d(),await g(6),t++,t>3?s():n())}}]}async function Y(){let t,u;a(),r=null,e=[{A:1,U:2,_(){if(t&&u)return i--?n():s();let e=H,r=I;R.forEach((n=>{o[l(e,r)]=n+(t?64:0);const c=12&n;0==c&&r--,4==c&&e++,8==c&&r++,12==c&&e--})),c.k=[208+(3&R[0])+(E?4:0)+(t?16:0),8*H,8*I],t=!t}}],await g(7),u=!0}e.push({U:7,_(){Q.forEach((t=>y[t]=111-V)),V--||(V=2)}}),e.push({_(){w(y,h,3,25),w(y,A,10,25),function(...t){for(let n=1008;n--;)o[n]=t.map((t=>t[n])).reduceRight(((t,n)=>n||t))}(O,k,p,y)}})}()}function v(t,n,e,o){t.addEventListener(n,e,o)}function M(t){return t&&Math.round(Math.random()*(t-1))}function P(t,n,e){return t>=n&&t<=e}function b(t){return new Promise((n=>setTimeout(n,t)))}S()})();